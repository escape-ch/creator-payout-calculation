Task: we need to build a bot detection tool using python with pandas and numpy and other libraries you might think is useful

Explanation: We have a social media view tracking system where we tack daily views of registered social media accounts to
our system. people are buying views, likes and engagement to trick the system. we need a statistical way to figure
out which posts or accounts are faking views or engagement.

we have different sources available to fetch data. I'm giving you the DDL definition of our database tables.

Your job is to come up with a very nice working approach to detect botted posts on account and post levels. 
We want a  model that works with probabilities and gives a percentage of what he thinks if a given post is botted or not.

We dont have a labeled data to train a machine learning data liek botted an not botted. come up with suggestions to implement
this in python, specicifacly in src/bot_detection.ipynb where "# TODO: CLAUDE implements here" is marked in a code box.

read the file first and understand how to fetch necessary data.

database tables you can work with look like this:

```sql

create table social_media_accounts (
  id             integer generated by default as identity not null,
  creator_id     integer                                  not null,
  campaign_id    integer                                  not null,
  country        "Country"                                not null,
  language       "Language"                               not null,
  app_platform   "AppPlatform"                            not null,
  channel        "SocialMediaAccountChannel"              not null,
  username       text                                     not null,
  avatar_url     text,
  first_post_at  timestamp,
  last_post_at   timestamp,
  total_views    integer                                  not null default 0,
  total_likes    integer                                  not null default 0,
  total_comments integer                                  not null default 0,
  total_saves    integer                                  not null default 0,
  total_shares   integer                                  not null default 0,
  total_posts    integer                                  not null default 0,
  metadata       jsonb                                    not null default '{}',
  registered_at  timestamp                                not null default current_timestamp,
  inserted_at    timestamptz                              not null default NOW(),
  updated_at     timestamptz                              not null default NOW()
);

create table social_media_posts (
  id                      text                        not null,
  thumbnail_url           text,
  social_media_account_id integer                     not null,
  account_creator_id      integer                     not null,
  account_campaign_id     integer                     not null,
  account_country         "Country"                   not null,
  account_language        "Language"                  not null,
  account_app_platform    "AppPlatform"               not null,
  account_channel         "SocialMediaAccountChannel" not null,
  account_username        text                        not null,
  account_avatar_url      text,
  account_metadata        jsonb                       not null default '{}',
  account_registered_at   timestamp                   not null default current_timestamp,
  last_scrape_at          timestamp                   not null,
  last_scrape_id          integer                     not null,
  posted_at               timestamp                   not null,
  posted_at_date          date                        not null generated always as ( posted_at::date ) stored,
  views                   integer                     not null default 0,
  likes                   integer                     not null default 0,
  comments                integer                     not null default 0,
  saves                   integer                     not null default 0,
  shares                  integer                     not null default 0,
  inserted_at             timestamptz                 not null default NOW(),
  updated_at              timestamptz                 not null default NOW()
);

create table if not exists "public".social_media_accounts_daily_diff (
  id                      integer                     not null,
  date                    date                        not null,
  date_previous           date,
  creator_id              integer                     not null,
  campaign_id             integer                     not null,
  country                 "Country"                   not null,
  language                "Language"                  not null,
  app_platform            "AppPlatform"               not null,
  channel                 "SocialMediaAccountChannel" not null,
  username                text                        not null,
  avatar_url              text,
  first_post_at           timestamp,
  last_post_at            timestamp,
  total_views             integer                     not null,
  total_likes             integer                     not null,
  total_comments          integer                     not null,
  total_saves             integer                     not null,
  total_shares            integer                     not null,
  total_posts             integer                     not null,
  total_views_previous    integer                     not null,
  total_likes_previous    integer                     not null,
  total_comments_previous integer                     not null,
  total_saves_previous    integer                     not null,
  total_shares_previous   integer                     not null,
  total_posts_previous    integer                     not null,
  total_views_diff        integer                     not null generated always as ( total_views - total_views_previous ) stored,
  total_likes_diff        integer                     not null generated always as ( total_likes - total_likes_previous ) stored,
  total_comments_diff     integer                     not null generated always as ( total_comments - total_comments_previous ) stored,
  total_saves_diff        integer                     not null generated always as ( total_saves - total_saves_previous ) stored,
  total_shares_diff       integer                     not null generated always as ( total_shares - total_shares_previous ) stored,
  total_posts_diff        integer                     not null generated always as ( total_posts - total_posts_previous ) stored,
  metadata                jsonb                       not null default '{}',
  registered_at           timestamp                   not null default current_timestamp,
  inserted_at             timestamptz                 not null default NOW(),
  updated_at              timestamptz                 not null default NOW()
);

create table if not exists "public".social_media_posts_daily_diff (
  id                      text                        not null,
  date                    date                        not null,
  date_previous           date,
  thumbnail_url           text,
  social_media_account_id integer                     not null,
  account_creator_id      integer                     not null,
  account_campaign_id     integer                     not null,
  account_country         "Country"                   not null,
  account_language        "Language"                  not null,
  account_app_platform    "AppPlatform"               not null,
  account_channel         "SocialMediaAccountChannel" not null,
  account_username        text                        not null,
  account_avatar_url      text,
  account_metadata        jsonb                       not null default '{}',
  account_registered_at   timestamp                   not null default current_timestamp,
  last_scrape_at          timestamp                   not null,
  last_scrape_at_previous timestamp,
  last_scrape_id          integer                     not null,
  last_scrape_id_previous integer,
  posted_at               timestamp                   not null,
  posted_at_date          date                        not null generated always as ( posted_at::date ) stored,
  views                   integer                     not null,
  likes                   integer                     not null,
  comments                integer                     not null,
  saves                   integer                     not null,
  shares                  integer                     not null,
  views_previous          integer                     not null,
  likes_previous          integer                     not null,
  comments_previous       integer                     not null,
  saves_previous          integer                     not null,
  shares_previous         integer                     not null,
  views_diff              integer                     not null generated always as ( views - views_previous ) stored,
  likes_diff              integer                     not null generated always as ( likes - likes_previous ) stored,
  comments_diff           integer                     not null generated always as ( comments - comments_previous ) stored,
  saves_diff              integer                     not null generated always as ( saves - saves_previous ) stored,
  shares_diff             integer                     not null generated always as ( shares - shares_previous ) stored,
  inserted_at             timestamptz                 not null default NOW(),
  updated_at              timestamptz                 not null default NOW()
);
```
